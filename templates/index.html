{% extends 'base.html' %}

{% block content %}

    {% if trending_posts %}
        <div class="section-header">
            <span class="section-title" style="color: #d35400;">üî• ‡¶è‡¶ñ‡¶® ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç (‡¶∏‡¶¨‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶ú‡¶®‡¶™‡ßç‡¶∞‡¶ø‡¶Ø‡¶º)</span>
        </div>

        <div style="display: flex; flex-direction: column; gap: 20px;">
            {% for post in trending_posts %}
                <div class="post" style="padding: 0; overflow: hidden;">

                    {% if post['trending_thumbnail'] %}
                        <img src="{{ url_for('static', filename='uploads/' + post['trending_thumbnail']) }}" 
                             style="width: 100%; height: 260px; object-fit: cover; border-radius: 0;">
                    {% else %}
                        <img src="{{ url_for('static', filename='uploads/' + post['thumbnail']) }}" 
                             style="width: 100%; height: 260px; object-fit: cover; border-radius: 0;">
                    {% endif %}

                    <div style="padding: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span class="tag" style="background: #d35400; color: white;">{{ post['category'] }}</span>
                            <span style="font-size: 0.85em; color: #666;">üëÅÔ∏è {{ post['views'] }} ‡¶ú‡¶® ‡¶¶‡ßá‡¶ñ‡ßá‡¶õ‡ßá‡¶®</span>
                        </div>

                        <h2 style="margin-top: 10px;">{{ post['title'] }}</h2>
                        <p style="color: #666;">{{ post['intro'] }}</p>
                        <a href="{{ url_for('post_detail', post_id=post['id']) }}" class="view-all-btn">‡¶™‡ßú‡ßÅ‡¶® &rarr;</a>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <div class="section-header">
        <span class="section-title">üïí ‡¶≤‡ßá‡¶ü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡ßã‡¶∏‡ßç‡¶ü (‡¶®‡¶§‡ßÅ‡¶® ‡ßß‡ß¶‡¶ü‡¶ø)</span>
        <a href="/list?type=latest" class="view-all-btn">‡¶∏‡¶¨ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</a>
    </div>

    <div style="display: grid; gap: 15px;">
        {% for post in latest_posts %}
            <div class="post" style="display: flex; gap: 15px; align-items: flex-start;">
                {% if post['thumbnail'] %}
                    <img src="{{ url_for('static', filename='uploads/' + post['thumbnail']) }}" 
                         style="width: 100px; height: 100px; object-fit: cover; flex-shrink: 0; border-radius: 8px;">
                {% endif %}

                <div>
                    <span class="tag">{{ post['category'] }}</span>
                    <h3 style="margin: 5px 0; font-size: 1.1rem;">{{ post['title'] }}</h3>
                    <p style="font-size: 0.9em; color: #666; margin-bottom: 5px;">{{ post['intro'][:50] }}...</p>
                    <small style="color: #888;">üëÅÔ∏è {{ post['views'] }} views</small> <br>
                    <a href="{{ url_for('post_detail', post_id=post['id']) }}" style="font-size: 0.9em; color: #2563eb; text-decoration: none;">‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§</a>
                </div>
            </div>
        {% endfor %}
    </div>

    {% for section in category_sections %}
        <div class="section-header">
            <span class="section-title">üìÇ {{ section.name }}</span>
            <a href="/list?type=category&category={{ section.name }}" class="view-all-btn">‡¶∏‡¶¨ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</a>
        </div>
        <div style="display: grid; gap: 15px; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));">
            {% for post in section.posts %}
                <div class="post" style="padding: 15px;">
                    {% if post['thumbnail'] %}
                        <img src="{{ url_for('static', filename='uploads/' + post['thumbnail']) }}" 
                             style="width: 100%; height: 150px; object-fit: cover; margin-bottom: 10px;">
                    {% endif %}
                    <h4 style="margin: 0 0 5px 0;">{{ post['title'] }}</h4>
                    <small style="color: #888; display: block; margin-bottom: 5px;">üëÅÔ∏è {{ post['views'] }} views</small>
                    <a href="{{ url_for('post_detail', post_id=post['id']) }}" style="font-size: 0.85em; color: #2563eb; text-decoration: none;">‡¶™‡ßú‡ßÅ‡¶® &rarr;</a>
                </div>
            {% endfor %}
        </div>
    {% endfor %}

{% endblock %}